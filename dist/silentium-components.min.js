!function(e,t,s){"use strict";class r{constructor(e,t){this.basePath=e,this.template=t}content(e){fetch(this.basePath+"/"+this.template).then((e=>e.text())).then((s=>{t.give(s,e)}))}}class i{constructor(e,t,s,r,i){this.loading=e,this.basePath=t,this.currentPage=s,this.display=r,this.pageTransport=i}routes(e){const s=e.find((e=>e.default)),r=new t.SourceAll;t.value(this.basePath,new t.Patron(r.guestKey("basePath"))),t.value(this.currentPage,new t.Patron(r.guestKey("currentPage"))),r.value(new t.Patron((({basePath:r,currentPage:i})=>{const n=i.replace(r,""),a=e.find((e=>e.aliases&&(e.aliases.includes(i)||e.aliases.includes(n))));if(a){const e=r+a.url;if(e!==i)return void t.give(e,this.currentPage)}let o=e.find((e=>{if(e.url.indexOf("*")>=0){return new RegExp(e.url.replaceAll("*",".*").replaceAll("/","/")).test(n)}return e.url.replaceAll("*","")===n}));if(!o&&s&&(o=s),!o)throw new Error("No matching route in Navigation");{const e=r.replace("/#","").replace("#","").replace(/[^/]+\.html$/,"");t.give(!0,this.loading),this.pageTransport.get(e,o.template).content((e=>{this.display.display(e),o.page.mounted(),t.give(!1,this.loading)}))}})))}}class n{constructor(e){this.selector=e}display(e){const t=document.querySelector(this.selector);t&&(t.innerHTML=e)}}var a=Object.defineProperty,o=(e,t,s)=>((e,t,s)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class l{constructor(){o(this,"source");const e=location.href.replace(location.origin,"");this.source=new t.SourceWithPool(e)}give(e){return this.source.give(e),this}value(e){return this.source.value(e),e}pool(){return this.source.pool()}}class c{constructor(e){this.selector=e}give(e){const t=document.querySelector(this.selector);return t&&(t.style.display=e?"block":"none"),this}}class u{constructor(e,t){this.linkSource=e,this.basePath=t}watchClick(e,t){const s=document.querySelectorAll(e);if(!s.length)throw new Error(`Link wrapper not found for selector ${e}`);s.forEach((e=>{e.addEventListener("click",(s=>{t?e.querySelectorAll(t).forEach((e=>{s?.target!==e&&s?.currentTarget!==e||this.handleClick({preventDefault:s.preventDefault.bind(s),target:e})})):this.handleClick(s)}))}))}handleClick(e){let s=e?.target?.getAttribute("href");s||(s=e?.currentTarget?.getAttribute("href")),s&&0!==s.indexOf("http")&&(e.preventDefault(),t.value(this.basePath,(e=>{this.linkSource.give(e+s)})))}}class h{constructor(e,t){this.sources=e,this.selectorTemplate=t}element(e){const s=new t.SourceAll;this.sources.forEach((r=>{r.source.value(new t.GuestCast(e,s.guestKey(r.placeholder)))})),s.value(new t.GuestCast(e,(s=>{let r=this.selectorTemplate;Object.entries(s).map((e=>{r=r.replaceAll(e[0],e[1])}));const i=document.querySelector(r);i&&t.give(i,e)})))}}class g{constructor(e,t,s){this.activeClass=e,this.groupSelector=t,this.document=s}give(e){return t.value(this.document,new t.PatronOnce((t=>{t.querySelectorAll(this.groupSelector).forEach((e=>{e.classList.remove(this.activeClass)})),e.classList.add(this.activeClass)}))),this}}var v=Object.defineProperty,p=(e,t,s)=>((e,t,s)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);var d=Object.defineProperty,w=(e,t,s)=>((e,t,s)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);var S=Object.defineProperty,m=(e,t,s)=>((e,t,s)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);e.ComputedElement=h,e.CurrentPage=l,e.Dirty=class{constructor(e,s=[],r=[],i=!1){this.alwaysKeep=s,this.excludeKeys=r,p(this,"comparingSource",new t.SourceWithPool),p(this,"all",new t.SourceAll),this.comparingSource.value(new t.Patron(this.all.guestKey("comparing"))),t.value(e,new t.Patron(this.all.guestKey("base"))),i&&t.value(e,new t.PatronOnce(this))}give(e){return t.give(JSON.parse(JSON.stringify(e)),this.comparingSource),this}value(e){return this.all.value(new t.GuestCast(e,(({comparing:s,base:r})=>{s&&t.give(Object.fromEntries(Object.entries(s).filter((([e,t])=>!!this.alwaysKeep.includes(e)||!this.excludeKeys.includes(e)&&t!==r[e]))),e)}))),this}},e.EntryPointPage=class{constructor(e,t){this.title=e,this.entryPointUrl=t}mounted(){document.title=this.title,import(this.entryPointUrl).then((e=>{e.main&&e.main()}))}},e.GroupActiveClass=g,e.HashTable=class{constructor(e){m(this,"source",new t.SourceWithPool({})),t.value(e,new t.Patron((([e,t])=>{this.source.value((s=>{s[e]=t}))})))}value(e){return t.value(this.source,e),this}},e.Input=class{constructor(e,s){this.source=e;const r=document.querySelector(s);this.source.value(new t.Patron((e=>{r.value=String(e)}))),r.addEventListener("keyup",(()=>{this.give(r.value)})),r.addEventListener("change",(()=>{this.give(r.value)}))}value(e){return this.source.value(e),this}give(e){return this.source.give(e),this}pool(){return this.source.pool()}},e.Link=u,e.Loading=class{constructor(e,s){this.loadingStartSource=e,this.loadingFinishSource=s,w(this,"loadingSource",new t.SourceWithPool)}value(e){return t.value(this.loadingStartSource,new t.GuestCast(e,(()=>{this.loadingSource.give(!0)}))),t.value(this.loadingFinishSource,new t.GuestCast(e,(()=>{this.loadingSource.give(!1)}))),this.loadingSource.value(e),this}},e.Navigation=i,e.Page=class{constructor(e){this.title=e}mounted(){document.title=this.title}},e.PageFetchTransport=r,e.Path=class{constructor(e,t){this.baseSource=e,this.keyType=t}value(e){const s=new t.SourceAll(["base","key"]);return t.value(this.baseSource,new t.GuestCast(e,s.guestKey("base"))),t.value(this.keyType,new t.GuestCast(e,s.guestKey("key"))),s.value(new t.GuestCast(e,(({base:s,key:r})=>{const i=r.split(".");let n=s;i.forEach((e=>{n=n[e]})),void 0!==n&&n!==s&&t.give(n,e)}))),this}},e.RouteDisplay=n,e.Router=class{constructor(e,t,s){this.loaderSelector=e,this.navigationResultSelector=t,this.menuSelector=s}routes(e,a,o,v){a||(a=new l),a.value(new t.Patron(new s.HistoryNewPage));const[p]=location.href.replace(location.origin,"").split("#");o||(o=new t.SourceWithPool(`${p}#`.replace("index.html","").replace("//","/")));const d=new t.SourceWithPool(!1);d.value(new t.Patron(new c(this.loaderSelector)));new s.HistoryPoppedPage(a).watchPop();new i(d,o,a,new n(this.navigationResultSelector),new t.PrivateClass(r)).routes(e);new u(a,o).watchClick(this.menuSelector);const w=new t.SourceAll;o.value(new t.Patron(w.guestKey("basePath"))),a.value(new t.Patron(w.guestKey("page")));const S=new t.Source((e=>{w.value(new t.GuestCast(e,(({basePath:s,page:r})=>{t.give(r.replace(s,""),e)})))}));new h([{source:S,placeholder:"{url}"}],`${this.menuSelector} a[href="{url}"]`).element(new t.Patron(new g("active",`${this.menuSelector} a`,t.sourceOf(document)))),d.value(new t.Patron((e=>{if(e)return;v&&v();const t=document.querySelector(this.navigationResultSelector);t&&t.querySelectorAll("script").forEach((e=>{const s=document.createElement("script");s.setAttribute("type","module"),s.appendChild(document.createTextNode(e.innerText)),t.appendChild(s)}))})))}},e.Text=class{constructor(e){this.selector=e}give(e){const t=document.querySelector(this.selector);return t&&(t.innerText=String(e)),this}},e.Touched=class{},e.Visible=c}({},silentium,silentiumWebApi);
