!function(e,t){"use strict";const l=e=>l=>{const i=Object.keys(e);t.all(...Object.values(e))((e=>{const t={};e.forEach(((e,l)=>{t[i[l]]=e})),l(t)}))},i=(e,l,i=t.of(""))=>r=>{t.all(e,l,i)((([e,t,l])=>{r(new RegExp(e,l).test(t))}))},r=()=>t.of(!1);e.and=(e,l)=>i=>{t.all(e,l)((([e,t])=>{i(e&&t)}))},e.bool=e=>l=>{t.applied(e,Boolean)(l)},e.branch=(e,l,i)=>r=>{const a=t.primitive(l);let o;void 0!==i&&(o=t.primitive(i)),e((e=>{let t=null;e?t=a.primitive():o&&(t=o.primitive()),null!==t&&r(t)}))},e.concatenated=(e,l=t.of(""))=>i=>{t.all(l,...e)((([e,...t])=>{i(t.join(e))}))},e.constant=(e,t)=>l=>{t((()=>{l(e)}))},e.deadline=(e,l,i)=>r=>{let a=null;const o=t.shared(l,!0);i((l=>{a&&clearTimeout(a);let i=!1;a=setTimeout((()=>{i||(i=!0,e(new Error("Timeout reached in Deadline class")))}),l);t.filtered(o.value,(()=>!i))(r),o.value((()=>{i=!0}))}))},e.deferred=(e,l)=>i=>{const r=t.primitive(e);l((()=>{const e=r.primitive();t.isFilled(e)&&i(e)}))},e.dirty=(e,l=[],i=[],r)=>{const a=t.late();return void 0===r&&(r=e=>JSON.parse(JSON.stringify(e))),{value:o=>{const n=t.applied(a.value,r);t.all(n,e)((([e,t])=>{e&&o(Object.fromEntries(Object.entries(e).filter((([e,r])=>!!l.includes(e)||!i.includes(e)&&r!==t[e]))))}))},give:e=>{a.give(e)}}},e.first=e=>l=>{t.applied(e,(e=>e[0]))(l)},e.fromJson=(e,t)=>l=>{e((e=>{try{l(JSON.parse(e))}catch(e){t?.(new Error(`Failed to parse JSON: ${e}`))}}))},e.hashTable=e=>t=>{const l={};e((([e,i])=>{l[e]=i,t(l)}))},e.loading=(e,t)=>l=>{e((()=>l(!0))),t((()=>l(!1)))},e.lock=(e,l)=>i=>{let r=!1;l((e=>{r=e}));t.filtered(e,(()=>!r))(i)},e.memo=e=>t=>{let l=null;e((e=>{e!==l&&(t(e),l=e)}))},e.not=e=>t=>{e((e=>{t(!e)}))},e.onlyChanged=e=>t=>{let l=!1;e((e=>{!1===l?l=!0:t(e)}))},e.or=(e,l)=>i=>{t.all(e,l)((([e,t])=>{i(e||t)}))},e.part=(e,l)=>{const i=t.primitive(e.value),r=t.primitive(l);return{value:i=>{t.all(e.value,l)((([e,t])=>{const l=t.split(".");let r=e;l.forEach((e=>{r=r[e]})),void 0!==r&&r!==e&&i(r)}))},give:l=>{const a=r.primitive();t.isFilled(a)&&e.give({...i.primitive(),[a]:l})}}},e.path=(e,l)=>i=>{t.all(e,l)((([e,t])=>{const l=t.split(".");let r=e;l.forEach((e=>{r=r[e]})),void 0!==r&&r!==e&&i(r)}))},e.polling=(e,t)=>l=>{t((()=>{e(l)}))},e.recordOf=l,e.regexpMatch=(e,l,i=t.of(""))=>r=>{t.all(e,l,i)((([e,t,l])=>{const i=new RegExp(e,l).exec(t);r(i??[])}))},e.regexpMatched=i,e.regexpReplaced=(e,l,i,r=t.of(""))=>a=>{t.all(l,e,i,r)((([e,t,l,i])=>{a(String(t).replace(new RegExp(e,i),l))}))},e.router=(e,l,a)=>o=>{t.all(l,e)((([e,l])=>{const n=t.all(a(),t.all(...e.map((e=>{return a=i(t.of(e.pattern),t.of(l),e.patternFlags?t.of(e.patternFlags):void 0),o=e.template,n=r,e=>{a((t=>{let l=null;t?l=o():n&&(l=n()),l&&l(e)}))};var a,o,n}))));t.applied(n,(e=>{const t=e[1].find((e=>!1!==e));return t||e[0]}))(o)}))},e.set=(e,l,i)=>r=>{t.all(e,l,i)((([e,t,l])=>{e[t]=l,r(e)}))},e.shot=(e,l)=>i=>{const r=t.primitive(e);l((()=>{const e=r.primitive();t.isFilled(e)&&i(e)}))},e.task=(e,l=0)=>i=>{let r=null;t.executorApplied(e,(e=>t=>{r&&clearTimeout(r),r=setTimeout((()=>{e(t)}),l)}))(i)},e.template=(e=t.of(""),i=t.of({}))=>{let r=0;const a={$TPL:t.of("$TPL")};return{value:r=>{const o=l(a);t.applied(t.all(e,i,o),(([e,t,l])=>(Object.entries(t).forEach((([t,l])=>{e=e.replaceAll(t,String(l))})),Object.entries(l).forEach((([t,l])=>{e=e.replaceAll(t,String(l))})),e)))(r)},template:l=>{e=t.of(l)},var:e=>{const t=`$var${r}`;return r+=1,a[t]=e,t}}},e.tick=e=>t=>{let l=!1,i=null;e((e=>{i=e,l||(l=!0,queueMicrotask((()=>{l=!1,null!==i&&(t(i),i=null)})))}))},e.toJson=(e,t)=>l=>{e((e=>{try{l(JSON.stringify(e))}catch{t?.(new Error("Failed to convert to JSON"))}}))}}({},silentium);
