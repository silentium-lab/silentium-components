{"version":3,"file":"silentium-components.min.mjs","sources":["../src/behaviors/Branch.ts","../src/behaviors/BranchLazy.ts","../src/behaviors/Const.ts","../src/behaviors/Deadline.ts","../src/behaviors/Deferred.ts","../src/behaviors/Detached.ts","../src/behaviors/Dirty.ts","../src/behaviors/Loading.ts","../src/behaviors/Lock.ts","../src/behaviors/Memo.ts","../src/behaviors/OnlyChanged.ts","../src/behaviors/Part.ts","../src/behaviors/Path.ts","../src/behaviors/Polling.ts","../src/behaviors/Shot.ts","../src/behaviors/Task.ts","../src/behaviors/Tick.ts","../src/behaviors/Transaction.ts","../src/structures/HashTable.ts","../src/structures/RecordOf.ts","../src/strings/Concatenated.ts","../src/strings/Template.ts","../src/system/RegexpMatched.ts","../src/system/RegexpReplaced.ts","../src/system/RegexpMatch.ts","../src/system/Set.ts","../src/navigation/Router.ts","../src/boolean/And.ts","../src/boolean/Or.ts","../src/boolean/Not.ts","../src/boolean/Bool.ts","../src/formats/FromJson.ts","../src/formats/ToJson.ts","../src/lists/First.ts"],"sourcesContent":["import { Event, EventType, Primitive, Transport } from \"silentium\";\n\n/**\n * https://silentium-lab.github.io/silentium-components/#/behaviors/branch\n */\nexport function Branch<Then, Else>(\n  $condition: EventType<boolean>,\n  $left: EventType<Then>,\n  $right?: EventType<Else>,\n): EventType<Then | Else> {\n  return Event((transport) => {\n    const left = Primitive($left);\n    let right: ReturnType<typeof Primitive<Else>>;\n    if ($right !== undefined) {\n      right = Primitive($right);\n    }\n    $condition.event(\n      Transport((v) => {\n        let result: Then | Else | null = null;\n        if (v) {\n          result = left.primitive();\n        } else if (right) {\n          result = right.primitive();\n        }\n        if (result !== null) {\n          transport.use(result);\n        }\n      }),\n    );\n  });\n}\n","import {\n  DestroyableType,\n  Event,\n  EventType,\n  isDestroyable,\n  Transport,\n  TransportType,\n} from \"silentium\";\n\nexport function BranchLazy<Then, Else>(\n  $condition: EventType<boolean>,\n  $left: TransportType<void, EventType<Then>>,\n  $right?: TransportType<void, EventType<Else>>,\n): EventType<Then | Else> & DestroyableType {\n  return Event((transport) => {\n    let destroyable: DestroyableType | undefined;\n    const destructor = () => {\n      if (destroyable !== undefined) {\n        destroyable.destroy();\n        destroyable = undefined;\n      }\n    };\n    $condition.event(\n      Transport((v) => {\n        destructor();\n        let instance: EventType<Then | Else> | undefined;\n        if (v) {\n          instance = $left.use();\n        } else if ($right) {\n          instance = $right.use();\n        }\n        if (instance !== undefined) {\n          instance.event(transport);\n          if (isDestroyable(instance)) {\n            destroyable = instance;\n          }\n        }\n      }),\n    );\n    return destructor;\n  });\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\nexport function Constant<T>(permanent: T, $trigger: EventType): EventType<T> {\n  return Event((transport) => {\n    $trigger.event(\n      Transport(() => {\n        transport.use(permanent);\n      }),\n    );\n  });\n}\n","import {\n  Event,\n  EventType,\n  TransportType,\n  Filtered,\n  Shared,\n  Transport,\n} from \"silentium\";\n\nexport function Deadline<T>(\n  error: TransportType<Error>,\n  $base: EventType<T>,\n  $timeout: EventType<number>,\n): EventType<T> {\n  return Event((transport) => {\n    let timer: ReturnType<typeof setTimeout> | number = 0;\n    const base = Shared($base, true);\n    $timeout.event(\n      Transport((timeout) => {\n        if (timer) {\n          clearTimeout(timer);\n        }\n        let timeoutReached = false;\n\n        timer = setTimeout(() => {\n          if (timeoutReached) {\n            return;\n          }\n          timeoutReached = true;\n          error.use(new Error(\"Timeout reached in Deadline\"));\n        }, timeout);\n\n        const f = Filtered(base, () => !timeoutReached);\n        f.event(transport);\n\n        base.event(\n          Transport(() => {\n            timeoutReached = true;\n          }),\n        );\n      }),\n    );\n  });\n}\n","import { Event, EventType, isFilled, Primitive, Transport } from \"silentium\";\n\n/**\n * Defer one source after another, gives values Of baseSrc only when triggerSrc responds\n * https://silentium-lab.github.io/silentium-components/#/behaviors/deferred\n */\nexport function Deferred<T>(\n  $base: EventType<T>,\n  $trigger: EventType<unknown>,\n): EventType<T> {\n  return Event((transport) => {\n    const base = Primitive($base);\n    $trigger.event(\n      Transport(() => {\n        const value = base.primitive();\n        if (isFilled(value)) {\n          transport.use(value);\n        }\n      }),\n    );\n  });\n}\n","import { Event, EventType, isFilled, Primitive } from \"silentium\";\n\nexport function Detached<T>($base: EventType<T>): EventType<T> {\n  return Event((transport) => {\n    const v = Primitive($base).primitive();\n    if (isFilled(v)) {\n      transport.use(v);\n    }\n  });\n}\n","import {\n  All,\n  Applied,\n  EventType,\n  Late,\n  SourceType,\n  Transport,\n  TransportType,\n} from \"silentium\";\n\n/**\n * Takes source and remember it first value\n * returns new record, what will contain only fields what was changed\n * https://silentium-lab.github.io/silentium-components/#/behaviors/dirty\n */\nexport function Dirty<T>(\n  $base: EventType<T>,\n  keep: string[] = [],\n  exclude: string[] = [],\n  cloner?: (v: T) => T,\n): SourceType<T> {\n  return new DirtySource($base, keep, exclude, cloner);\n}\n\nclass DirtySource<T> implements SourceType<T> {\n  private $comparing = Late<T>();\n  private cloner: (v: T) => T;\n\n  public constructor(\n    private $base: EventType<T>,\n    private keep: string[] = [],\n    private exclude: string[] = [],\n    cloner?: (v: T) => T,\n  ) {\n    if (cloner === undefined) {\n      this.cloner = (value) => JSON.parse(JSON.stringify(value));\n    } else {\n      this.cloner = cloner;\n    }\n  }\n\n  public event(transport: TransportType<T>) {\n    const $comparing = Applied(this.$comparing, this.cloner);\n    All($comparing, this.$base).event(\n      Transport(([comparing, base]) => {\n        if (!comparing) {\n          return;\n        }\n        transport.use(\n          Object.fromEntries(\n            Object.entries(comparing).filter(([key, value]) => {\n              if (this.keep.includes(key)) {\n                return true;\n              }\n              if (this.exclude.includes(key)) {\n                return false;\n              }\n              return value !== (base as Record<string, unknown>)[key];\n            }),\n          ) as T,\n        );\n      }),\n    );\n    return this;\n  }\n\n  public use(v: T) {\n    this.$comparing.use(v);\n    return this;\n  }\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\n/**\n * Representation Of loading process\n * first event begins loading\n * second event stops loading\n * https://silentium-lab.github.io/silentium-components/#/behaviors/loading\n */\nexport function Loading(\n  $loadingStart: EventType<unknown>,\n  $loadingFinish: EventType<unknown>,\n): EventType<boolean> {\n  return Event((transport) => {\n    $loadingStart.event(Transport(() => transport.use(true)));\n    $loadingFinish.event(Transport(() => transport.use(false)));\n  });\n}\n","import { Event, EventType, Filtered, Transport } from \"silentium\";\n\n/**\n * https://silentium-lab.github.io/silentium-components/#/behaviors/lock\n */\nexport function Lock<T>(\n  $base: EventType<T>,\n  $lock: EventType<boolean>,\n): EventType<T> {\n  return Event((transport) => {\n    let locked = false;\n    $lock.event(\n      Transport((newLock) => {\n        locked = newLock;\n      }),\n    );\n    const i = Filtered($base, () => !locked);\n    i.event(transport);\n  });\n}\n","import { Event, EventType, isFilled, Transport } from \"silentium\";\n\n/**\n * Didn't respond if new value Of baseSrc equals to old value\n * https://silentium-lab.github.io/silentium-components/#/behaviors/memo\n */\nexport function Memo<T>($base: EventType<T>): EventType<T> {\n  return Event((transport) => {\n    let last: T | null = null;\n    $base.event(\n      Transport((v) => {\n        if (v !== last && isFilled(v)) {\n          transport.use(v);\n          last = v;\n        }\n      }),\n    );\n  });\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\n/**\n * Represents source what was changed at least once\n * https://silentium-lab.github.io/silentium-components/#/behaviors/only-changed\n */\nexport function OnlyChanged<T>($base: EventType<T>): EventType<T> {\n  return Event((transport) => {\n    let first = false;\n    $base.event(\n      Transport((v) => {\n        if (first === false) {\n          first = true;\n        } else {\n          transport.use(v);\n        }\n      }),\n    );\n  });\n}\n","import {\n  All,\n  EventType,\n  isFilled,\n  Primitive,\n  Shared,\n  SharedSource,\n  SourceType,\n  Transport,\n  TransportType,\n} from \"silentium\";\n\n/**\n * Return source Of record path\n * https://silentium-lab.github.io/silentium-components/#/behaviors/path\n */\nexport function Part<\n  R,\n  T extends object | Array<any> = any,\n  K extends string = any,\n>($base: SourceType<T>, $key: EventType<K>): SourceType<R> {\n  return new PartEvent($base, $key);\n}\n\nclass PartEvent<R, T extends object | Array<any>, K extends string = any>\n  implements SourceType<R>\n{\n  private $base: SourceType<T>;\n  private $keyed: EventType<K>;\n\n  public constructor($base: SourceType<T>, $key: EventType<K>) {\n    this.$base = SharedSource($base);\n    this.$keyed = Shared($key);\n  }\n\n  public event(transport: TransportType<R, null>): this {\n    All(this.$base, this.$keyed).event(\n      Transport(([base, keyed]) => {\n        const keys = keyed.split(\".\");\n        let value: unknown = base;\n        keys.forEach((key) => {\n          value = (value as Record<string, unknown>)[key];\n        });\n        if (value !== undefined && value !== base) {\n          transport.use(value as R);\n        }\n      }),\n    );\n    return this;\n  }\n\n  public use(value: R): this {\n    const key = Primitive(this.$keyed);\n    if (isFilled(key)) {\n      const base = Primitive(this.$base);\n      this.$base.use({\n        ...base.primitiveWithException(),\n        [key.primitiveWithException()]: value,\n      } as T);\n    }\n    return this;\n  }\n}\n","import { All, Event, EventType, Transport } from \"silentium\";\n\n/**\n * Return source Of record path\n * https://silentium-lab.github.io/silentium-components/#/behaviors/path\n */\nexport function Path<\n  R,\n  T extends object | Array<any> = any,\n  K extends string = any,\n>($base: EventType<T>, $keyed: EventType<K>): EventType<R> {\n  return Event((transport) => {\n    All($base, $keyed).event(\n      Transport(([base, keyed]) => {\n        const keys = keyed.split(\".\");\n        let value: unknown = base;\n        keys.forEach((key) => {\n          value = (value as Record<string, unknown>)[key];\n        });\n        if (value !== undefined && value !== base) {\n          transport.use(value as R);\n        }\n      }),\n    );\n  });\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\nexport function Polling<T>(\n  $base: EventType<T>,\n  $trigger: EventType<T>,\n): EventType<T> {\n  return Event((transport) => {\n    $trigger.event(\n      Transport(() => {\n        $base.event(transport);\n      }),\n    );\n  });\n}\n","import { Event, EventType, isFilled, Primitive, Transport } from \"silentium\";\n\n/**\n * Helps to represent only last fresh value Of some source, refreshing controls by shotSrc\n * https://silentium-lab.github.io/silentium-components/#/behaviors/shot\n */\nexport function Shot<T>(\n  $target: EventType<T>,\n  $trigger: EventType,\n): EventType<T> {\n  return Event((transport) => {\n    const targetSync = Primitive($target);\n    targetSync.primitive();\n\n    $trigger.event(\n      Transport(() => {\n        const value = targetSync.primitive();\n        if (isFilled(value)) {\n          transport.use(value);\n        }\n      }),\n    );\n  });\n}\n","import { Event, EventType, ExecutorApplied } from \"silentium\";\n\nexport function Task<T>(\n  baseSrc: EventType<T>,\n  delay: number = 0,\n): EventType<T> {\n  return Event((transport) => {\n    let prevTimer: unknown | null = null;\n    ExecutorApplied(baseSrc, (fn) => {\n      return (v) => {\n        if (prevTimer) {\n          clearTimeout(prevTimer as number);\n        }\n        prevTimer = setTimeout(() => {\n          fn(v);\n        }, delay);\n      };\n    }).event(transport);\n  });\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\n/**\n * Accumulates the last value Of the source and returns one result once per tick\n * https://silentium-lab.github.io/silentium-components/#/behaviors/tick\n */\nexport function Tick<T>($base: EventType<T>): EventType<T> {\n  return Event((transport) => {\n    let microtaskScheduled = false;\n    let lastValue: T | null = null;\n\n    const scheduleMicrotask = () => {\n      microtaskScheduled = true;\n      queueMicrotask(() => {\n        microtaskScheduled = false;\n        if (lastValue !== null) {\n          transport.use(lastValue);\n          lastValue = null;\n        }\n      });\n    };\n\n    $base.event(\n      Transport((v) => {\n        lastValue = v;\n        if (!microtaskScheduled) {\n          scheduleMicrotask();\n        }\n      }),\n    );\n  });\n}\n","import {\n  ConstructorType,\n  DestroyableType,\n  Event,\n  EventType,\n  LateShared,\n  Of,\n  Transport,\n} from \"silentium\";\nimport { Detached } from \"../behaviors/Detached\";\n\n/**\n * Do something on event value.\n * Each event value will create new eventBuilder instance\n */\nexport function Transaction<T, R = unknown>(\n  $base: EventType<T>,\n  eventBuilder: ConstructorType<\n    [EventType<T>, ...EventType<any>[]],\n    EventType<R>\n  >,\n  ...args: EventType[]\n): EventType<R> {\n  return Event((transport) => {\n    const $res = LateShared<R>();\n    const destructors: DestroyableType[] = [];\n\n    $base.event(\n      Transport((v) => {\n        const $event = eventBuilder(Of(v), ...args.map((a) => Detached(a)));\n        destructors.push($event as unknown as DestroyableType);\n        $event.event($res);\n      }),\n    );\n    $res.event(transport);\n\n    return () => {\n      destructors.forEach((d) => d?.destroy());\n      destructors.length = 0;\n    };\n  });\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\n/**\n * https://silentium-lab.github.io/silentium-components/#/structures/hash-table\n */\nexport function HashTable<T>(\n  $base: EventType<[string, unknown]>,\n): EventType<T> {\n  return Event((transport) => {\n    const record: Record<string, unknown> = {};\n\n    $base.event(\n      Transport(([key, value]) => {\n        record[key] = value;\n        transport.use(record as T);\n      }),\n    );\n  });\n}\n","import { All, Event, EventType, Transport } from \"silentium\";\n\ntype UnInformation<T> = T extends EventType<infer U> ? U : never;\n\n/**\n * Returns record Of data from record Of sources\n * https://silentium-lab.github.io/silentium-components/#/structures/record\n */\nexport function RecordOf<T extends EventType>(\n  record: Record<string, T>,\n): EventType<Record<string, UnInformation<T>>> {\n  return Event((transport) => {\n    const keys = Object.keys(record);\n    All(...Object.values(record)).event(\n      Transport((entries) => {\n        const record: Record<string, any> = {};\n        entries.forEach((entry, index) => {\n          record[keys[index]] = entry;\n        });\n        transport.use(record);\n      }),\n    );\n  });\n}\n","import { All, Event, EventType, Of, Transport } from \"silentium\";\n\n/**\n * Join sources Of strings to one source\n * https://silentium-lab.github.io/silentium-components/#/string/concatenated\n */\nexport function Concatenated(\n  sources: EventType<string>[],\n  joinPartSrc: EventType<string> = Of(\"\"),\n): EventType<string> {\n  return Event((transport) => {\n    All(joinPartSrc, ...sources).event(\n      Transport(([joinPart, ...strings]) => {\n        transport.use(strings.join(joinPart));\n      }),\n    );\n  });\n}\n","import {\n  All,\n  Applied,\n  DestroyableType,\n  DestroyContainer,\n  EventType,\n  isDestroyable,\n  Of,\n  TransportType,\n} from \"silentium\";\nimport { RecordOf } from \"../structures\";\n\nexport function Template(\n  $src: EventType<string> = Of(\"\"),\n  $places: EventType<Record<string, unknown>> = Of({}),\n) {\n  return new TemplateEvent($src, $places);\n}\n\nclass TemplateEvent implements EventType<string>, DestroyableType {\n  private dc = DestroyContainer();\n  private vars: Record<string, EventType> = {\n    $TPL: Of(\"$TPL\"),\n  };\n\n  public constructor(\n    private $src: EventType<string> = Of(\"\"),\n    private $places: EventType<Record<string, unknown>> = Of({}),\n  ) {}\n\n  public event(transport: TransportType<string, null>): this {\n    const $vars = RecordOf(this.vars);\n    Applied(All(this.$src, this.$places, $vars), ([base, rules, vars]) => {\n      Object.entries(rules).forEach(([ph, val]) => {\n        base = base.replaceAll(ph, String(val));\n      });\n      Object.entries(vars).forEach(([ph, val]) => {\n        base = base.replaceAll(ph, String(val));\n      });\n\n      return base;\n    }).event(transport);\n    return this;\n  }\n\n  public template(value: string) {\n    this.$src = Of(value);\n  }\n\n  /**\n   * Ability to register variable\n   * in concrete place Of template\n   */\n  public var(src: EventType<string>) {\n    const places = Object.keys(this.vars).length;\n    const varName = `$var${places}`;\n    if (isDestroyable(src)) {\n      this.dc.add(src);\n    }\n    this.vars[varName] = src;\n    return varName;\n  }\n\n  public destroy(): this {\n    this.dc.destroy();\n    return this;\n  }\n}\n","import { All, Event, EventType, Of, Transport } from \"silentium\";\n\n/**\n * Boolean source what checks what string matches pattern\n * https://silentium-lab.github.io/silentium-components/#/system/regexp-matched\n */\nexport function RegexpMatched(\n  patternSrc: EventType<string>,\n  valueSrc: EventType<string>,\n  flagsSrc: EventType<string> = Of(\"\"),\n): EventType<boolean> {\n  return Event((transport) => {\n    All(patternSrc, valueSrc, flagsSrc).event(\n      Transport(([pattern, value, flags]) => {\n        transport.use(new RegExp(pattern, flags).test(value));\n      }),\n    );\n  });\n}\n","import { All, Event, EventType, Of, Transport } from \"silentium\";\n\n/**\n * Returns string replaced by regular expression pattern\n * https://silentium-lab.github.io/silentium-components/#/system/regexp-replaced\n */\nexport function RegexpReplaced(\n  valueSrc: EventType<string>,\n  patternSrc: EventType<string>,\n  replaceValueSrc: EventType<string>,\n  flagsSrc: EventType<string> = Of(\"\"),\n): EventType<string> {\n  return Event((transport) => {\n    All(patternSrc, valueSrc, replaceValueSrc, flagsSrc).event(\n      Transport(([pattern, value, replaceValue, flags]) => {\n        transport.use(\n          String(value).replace(new RegExp(pattern, flags), replaceValue),\n        );\n      }),\n    );\n  });\n}\n","import { All, Event, EventType, Of, Transport } from \"silentium\";\n\n/**\n * First match Of regexp\n * https://silentium-lab.github.io/silentium-components/#/system/regexp-matched\n */\nexport function RegexpMatch(\n  patternSrc: EventType<string>,\n  valueSrc: EventType<string>,\n  flagsSrc: EventType<string> = Of(\"\"),\n): EventType<string[]> {\n  return Event((transport) => {\n    All(patternSrc, valueSrc, flagsSrc).event(\n      Transport(([pattern, value, flags]) => {\n        const result = new RegExp(pattern, flags).exec(value);\n        transport.use(result ?? []);\n      }),\n    );\n  });\n}\n","import { All, Event, EventType, Transport } from \"silentium\";\n\n/**\n * Ability to mutate some object, helpful when integrate to procedure systems\n * https://silentium-lab.github.io/silentium-components/#/system/set\n */\nexport function Set<T extends Record<string, unknown>>(\n  baseSrc: EventType<T>,\n  keySrc: EventType<string>,\n  valueSrc: EventType<unknown>,\n): EventType<T> {\n  return Event((transport) => {\n    All(baseSrc, keySrc, valueSrc).event(\n      Transport(([base, key, value]) => {\n        (base as Record<string, unknown>)[key] = value;\n        transport.use(base);\n      }),\n    );\n  });\n}\n","import {\n  All,\n  Applied,\n  DestroyableType,\n  Event,\n  EventType,\n  Of,\n  Transport,\n  TransportDestroyable,\n  TransportEvent,\n  TransportType,\n} from \"silentium\";\nimport { BranchLazy } from \"../behaviors\";\nimport { RegexpMatched } from \"../system\";\n\nexport interface Route<T> {\n  pattern: string;\n  patternFlags?: string;\n  event: TransportType<[], EventType<T>>;\n}\n\nconst $empty = TransportEvent(() => Of(false));\n\n/**\n * Router component what will return template if url matches pattern\n * https://silentium-lab.github.io/silentium-components/#/navigation/router\n */\nexport function Router<T = \"string\">(\n  $url: EventType<string>,\n  $routes: EventType<Route<T>[]>,\n  $default: TransportType<void, EventType<T>>,\n): EventType<T> & DestroyableType {\n  return Event<T>((transport) => {\n    const destructors: DestroyableType[] = [];\n    const destructor = () => {\n      destructors.forEach((d) => d.destroy());\n      destructors.length = 0;\n    };\n    All($routes, $url).event(\n      Transport(([routes, url]) => {\n        destructor();\n        const instance = All(\n          $default.use(),\n          All(\n            ...routes.map((r) => {\n              const $template = TransportDestroyable(r.event);\n              destructors.push($template);\n              return BranchLazy(\n                RegexpMatched(\n                  Of(r.pattern),\n                  Of(url),\n                  r.patternFlags ? Of(r.patternFlags) : undefined,\n                ),\n                $template,\n                $empty,\n              );\n            }),\n          ),\n        );\n\n        // Return first not false or default\n        Applied(instance, (r) => {\n          const first = r[1].find((r: unknown) => r !== false);\n          if (first) {\n            return first as T;\n          }\n          return r[0];\n        }).event(transport);\n      }),\n    );\n\n    return destructor;\n  });\n}\n","import { All, Event, EventType, Transport } from \"silentium\";\n\n/**\n * https://silentium-lab.github.io/silentium-components/#/boolean/and\n */\nexport function And(\n  $one: EventType<boolean>,\n  $two: EventType<boolean>,\n): EventType<boolean> {\n  return Event((transport) => {\n    All($one, $two).event(\n      Transport(([one, two]) => {\n        transport.use(one && two);\n      }),\n    );\n  });\n}\n","import { All, Event, EventType, Transport } from \"silentium\";\n\n/**\n * https://silentium-lab.github.io/silentium-components/#/boolean/or\n */\nexport function Or(\n  $one: EventType<boolean>,\n  $two: EventType<boolean>,\n): EventType<boolean> {\n  return Event((transport) => {\n    All($one, $two).event(\n      Transport(([one, two]) => {\n        transport.use(one || two);\n      }),\n    );\n  });\n}\n","import { Event, EventType, Transport } from \"silentium\";\n\n/**\n * https://silentium-lab.github.io/silentium-components/#/boolean/not\n */\nexport function Not($base: EventType<boolean>): EventType<boolean> {\n  return Event((transport) => {\n    $base.event(\n      Transport((v) => {\n        transport.use(!v);\n      }),\n    );\n  });\n}\n","import { Applied, Event, EventType } from \"silentium\";\n\n/**\n * Convert Any source to boolean source\n * https://silentium-lab.github.io/silentium-components/#/boolean/bool\n */\nexport function Bool($base: EventType): EventType<boolean> {\n  return Event((transport) => {\n    Applied($base, Boolean).event(transport);\n  });\n}\n","import { Event, EventType, Transport, TransportType } from \"silentium\";\n\n/**\n * Represents object from json\n */\nexport function FromJson<T = Record<string, unknown>>(\n  $json: EventType<string>,\n  error?: TransportType,\n): EventType<T> {\n  return Event((transport) => {\n    $json.event(\n      Transport((json) => {\n        try {\n          transport.use(JSON.parse(json));\n        } catch (e) {\n          error?.use(new Error(`Failed to parse JSON: ${e}`));\n        }\n      }),\n    );\n  });\n}\n","import { Event, EventType, Transport, TransportType } from \"silentium\";\n\n/**\n * Represents json from object\n */\nexport function ToJson(\n  $data: EventType,\n  error?: TransportType,\n): EventType<string> {\n  return Event((transport) => {\n    $data.event(\n      Transport((data: unknown) => {\n        try {\n          transport.use(JSON.stringify(data));\n        } catch {\n          error?.use(new Error(\"Failed to convert to JSON\"));\n        }\n      }),\n    );\n  });\n}\n","import { Applied, Event, EventType } from \"silentium\";\n\n/**\n * Represents the first element Of an array.\n */\nexport function First<T extends Array<unknown>>(\n  $base: EventType<T>,\n): EventType<T[0]> {\n  return Event((transport) => {\n    Applied($base, (a) => a[0]).event(transport);\n  });\n}\n"],"names":["Branch","$condition","$left","$right","Event","transport","left","Primitive","right","event","Transport","v","result","primitive","use","BranchLazy","destroyable","destructor","destroy","instance","isDestroyable","Constant","permanent","$trigger","Deadline","error","$base","$timeout","timer","base","Shared","timeout","clearTimeout","timeoutReached","setTimeout","Error","Filtered","Deferred","value","isFilled","Detached","Dirty","keep","exclude","cloner","DirtySource","constructor","this","__publicField","Late","JSON","parse","stringify","$comparing","Applied","All","comparing","Object","fromEntries","entries","filter","key","includes","Loading","$loadingStart","$loadingFinish","Lock","$lock","locked","newLock","Memo","last","OnlyChanged","first","Part","$key","PartEvent","SharedSource","$keyed","keyed","keys","split","forEach","primitiveWithException","Path","Polling","Shot","$target","targetSync","Task","baseSrc","delay","prevTimer","ExecutorApplied","fn","Tick","microtaskScheduled","lastValue","queueMicrotask","Transaction","eventBuilder","args","$res","LateShared","destructors","$event","Of","map","a","push","d","length","HashTable","record","RecordOf","values","entry","index","Concatenated","sources","joinPartSrc","joinPart","strings","join","Template","$src","$places","TemplateEvent","DestroyContainer","$TPL","$vars","vars","rules","ph","val","replaceAll","String","template","src","varName","dc","add","RegexpMatched","patternSrc","valueSrc","flagsSrc","pattern","flags","RegExp","test","RegexpReplaced","replaceValueSrc","replaceValue","replace","RegexpMatch","exec","Set","keySrc","$empty","TransportEvent","Router","$url","$routes","$default","routes","url","r","$template","TransportDestroyable","patternFlags","find","And","$one","$two","one","two","Or","Not","Bool","Boolean","FromJson","$json","json","e","ToJson","$data","data","First"],"mappings":"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"}