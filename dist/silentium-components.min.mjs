import{ActualMessage as n,Message as t,Primitive as e,DestroyContainer as i,Shared as r,Filtered as o,isFilled as c,Late as u,MessageSource as s,Applied as f,All as h,Empty as l,Nothing as a,ExecutorApplied as p,Of as d,LateShared as v,isMessage as m,Rejections as g,isDestroyable as y}from"silentium";function E(i,r,o){const c=n(i),u=n(r),s=o&&n(o);return t((function(n){const t=e(u);let i;void 0!==s&&(i=e(s)),c.then((e=>{let r=null;e?r=t.primitive():i&&(r=i.primitive()),null!==r&&n(r)}))}))}function O(n,e,r){return t((function(t){const o=i(),c=()=>{o.destroy()};return n.then((n=>{let i;c(),n?i=e():r&&(i=r()),void 0!==i&&(i.then(t),o.add(i))})),c}))}function b(n,e){return t((function(t){e.then((()=>{t(n)}))}))}function j(e,i){const c=n(i);return t((function(n,t){let i=0;const u=r(e);c.then((e=>{i&&clearTimeout(i);let r=!1;i=setTimeout((()=>{r||(r=!0,t(new Error("Timeout reached in Deadline")))}),e);o(u,(()=>!r)).then(n),u.then((()=>{r=!0}))}))}))}function S(n,i){return t((function(t){const r=e(n);i.then((()=>{const n=r.primitive();c(n)&&t(n)}))}))}function w(n){return t((function(t){const i=e(n).primitive();c(i)&&t(i)}))}function $(n,t=[],e=[],i){const r=u();return void 0===i&&(i=n=>JSON.parse(JSON.stringify(n))),s((function(o){const c=f(r,i);h(c,n).then((([n,i])=>{n&&o(Object.fromEntries(Object.entries(n).filter((([n,r])=>!!t.includes(n)||!e.includes(n)&&r!==i[n]))))}))}),(n=>{r.use(n)}))}function x(n,e){return t((function(t){n.then((()=>t(!0))),e.then((()=>t(!1)))}))}function T(n,e){return t((function(t){let i=!1;e.then((n=>{i=n}));o(n,(()=>!i)).then(t)}))}function J(n){return t((function(t){let e=null;n.then((n=>{n!==e&&c(n)&&(t(n),e=n)}))}))}function N(n){return t((function(t){let e=!1;n.then((n=>{!1===e?e=!0:t(n)}))}))}function F(t,i){const o=r(t),u=r(n(i));return s((function(n){h(o,u).then((([t,e])=>{const i=e.split(".");let r=t;i.forEach((n=>{r=r[n]})),void 0!==r&&r!==t&&n(r)}))}),(n=>{const i=e(u);if(c(i)){const r=e(t);t.use({...r.primitiveWithException(),[i.primitiveWithException()]:n})}}))}function P(e,i,r){const o=n(i),c=n(r);return t((function(n){h(e,o,c).then((([t,e,i])=>{const r=e.split(".");let o=t;r.forEach((n=>{o=o[n]})),void 0!==o&&o!==t?n(o):void 0!==i&&n(i)}))}))}function R(t,e){const i=n(t),r=n(e);return l(P(i,r,a))}function k(n,e){return t((function(t){e.then((()=>{n.then(t)}))}))}function A(n,i){return t((function(t){const r=e(n);r.primitive(),i.then((()=>{const n=r.primitive();c(n)&&t(n)}))}))}function D(e,i=0){const r=n(e);return t((function(n){let t=null;p(r,(n=>e=>{t&&clearTimeout(t),t=setTimeout((()=>{n(e)}),i)})).then(n)}))}function L(n){return t((function(t){let e=!1,i=null;n.then((n=>{i=n,e||(e=!0,queueMicrotask((()=>{e=!1,null!==i&&(t(i),i=null)})))}))}))}function M(n,e){return t((function(t){h(n,e).then((([n,e])=>{t(!(!n||!e))}))}))}function W(n){return t((function(t){f(n,Boolean).then(t)}))}function q(n){return t((function(t){n.then((n=>{t(!n)}))}))}function B(n,e){return t((function(t){h(n,e).then((([n,e])=>{t(!(!n&&!e))}))}))}function I(n){return t((function(t,e){n.then((n=>{try{t(JSON.parse(n))}catch(n){e(new Error(`Failed to parse JSON: ${n}`))}}))}))}function z(n){return t((function(t,e){n.then((n=>{try{t(JSON.stringify(n))}catch{e(new Error("Failed to convert to JSON"))}}))}))}function C(n){return t((function(t){f(n,(n=>n[0])).then(t)}))}function G(e,i,r=d("")){const o=n(e),c=n(i),u=n(r);return t((function(n){h(o,c,u).then((([t,e,i])=>{const r=new RegExp(t,i).exec(e);n(r??[])}))}))}function H(e,i,r=d("")){const o=n(e),c=n(i),u=n(r);return t((function(n){h(o,c,u).then((([t,e,i])=>{n(new RegExp(t,i).test(e))}))}))}function K(n,e,i,r=d("")){return t((function(t){h(e,n,i,r).then((([n,e,i,r])=>{t(String(e).replace(new RegExp(n,r),i))}))}))}function Q(e,i,r){const o=n(e),c=n(i),u=n(r);return t((function(n){h(o,c,u).then((([t,e,i])=>{t[e]=i,n(t)}))}))}function U(e,r,o){const c=n(r);return t((function(n){const t=i(),r=()=>{t.destroy()};return h(c,e).then((([e,i])=>{r();h(...e.map((n=>H(d(n.pattern),d(i),n.patternFlags?d(n.patternFlags):void 0)))).then((i=>{const r=i.findIndex((n=>!0===n));if(-1===r){const e=o();t.add(e),e.then(n)}if(r>-1){const i=e[r].message();t.add(i),i.then(n)}}))})),r}))}function V(n,e=d("")){return t((function(t){h(e,...n).then((([n,...e])=>{t(e.join(n))}))}))}function X(n){return t((function(t){const e={};n.then((([n,i])=>{e[n]=i,t(e)}))}))}function Y(e){return t((function(t){const i=Object.keys(e);i.forEach((t=>{e[t]=n(e[t])})),h(...Object.values(e)).then((n=>{const e={};n.forEach(((n,t)=>{e[i[t]]=n})),t(e)}))}))}var Z=Object.defineProperty,_=(n,t,e)=>((n,t,e)=>t in n?Z(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e)(n,"symbol"!=typeof t?t+"":t,e);function nn(e="",i=d({})){const r=v();("string"==typeof e||m(e))&&r.chain(n(e));const o=new tn(r,i?n(i):void 0);return"function"==typeof e&&r.chain(t((n=>{n(e(o))}))),o}class tn{constructor(n=d(""),t=d({})){this.$src=n,this.$places=t,_(this,"dc",i()),_(this,"rejections",new g),_(this,"vars",{$TPL:d("$TPL")})}then(n){const t=Y(this.vars);return f(h(this.$src,this.$places,t),(([n,t,e])=>{try{Object.entries(t).forEach((([t,e])=>{n=n.replaceAll(t,String(e))})),Object.entries(e).forEach((([t,e])=>{n=n.replaceAll(t,String(e))}))}catch(n){this.rejections.reject(n)}return n})).then(n),this}template(n){this.$src=d(n)}var(n){const t=`$var${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;return y(n)&&this.dc.add(n),this.vars[t]=n,t}catch(n){return this.rejections.catch(n),this}destroy(){return this.dc.destroy(),this}}export{M as And,W as Bool,E as Branch,O as BranchLazy,V as Concatenated,b as Constant,j as Deadline,S as Deferred,w as Detached,$ as Dirty,C as First,I as FromJson,X as HashTable,x as Loading,T as Lock,J as Memo,q as Not,N as OnlyChanged,B as Or,F as Part,P as Path,R as PathExisted,k as Polling,Y as Record,G as RegexpMatch,H as RegexpMatched,K as RegexpReplaced,U as Router,Q as Set,A as Shot,D as Task,nn as Template,L as Tick,z as ToJson};
//# sourceMappingURL=silentium-components.min.mjs.map
