import{ActualMessage as n,Message as t,Primitive as e,DestroyContainer as r,Shared as i,Filtered as o,isFilled as c,LateShared as u,MessageSource as s,Applied as f,All as h,Empty as l,Nothing as a,ExecutorApplied as p,Of as d,isMessage as v,Rejections as m,isDestroyable as y}from"silentium";function g(r,i,o){const c=n(r),u=n(i),s=o&&n(o);return t((function(n){const t=e(u);let r;void 0!==s&&(r=e(s)),c.then((e=>{let i=null;e?i=t.primitive():r&&(i=r.primitive()),null!==i&&n(i)}))}))}function E(n,e,i){return t((function(t){const o=r(),c=()=>{o.destroy()};return n.then((n=>{let r;c(),n?r=e():i&&(r=i()),void 0!==r&&(r.then(t),o.add(r))})),c}))}function b(n,e){return t((function(t){e.then((()=>{t(n)}))}))}function j(e,r){const c=n(r);return t((function(n,t){let r=0;const u=i(e);c.then((e=>{r&&clearTimeout(r);let i=!1;r=setTimeout((()=>{i||(i=!0,t(new Error("Timeout reached in Deadline")))}),e);o(u,(()=>!i)).then(n),u.then((()=>{i=!0}))}))}))}function O(n,r){return t((function(t){const i=e(n);r.then((()=>{const n=i.primitive();c(n)&&t(n)}))}))}function S(n){return t((function(t){const r=e(n).primitive();c(r)&&t(r)}))}function w(n,t=[],e=[],r){const i=u({});return void 0===r&&(r=n=>JSON.parse(JSON.stringify(n))),s((function(o){const c=f(i,r);h(c,n).then((([n,r])=>{n&&o(Object.fromEntries(Object.entries(n).filter((([n,i])=>!!t.includes(n)||!e.includes(n)&&i!==r[n]))))}))}),(n=>{i.use(n)}))}function $(n,e){return t((function(t){n.then((()=>t(!0))),e.then((()=>t(!1)))}))}function x(n,e){return t((function(t){let r=!1;e.then((n=>{r=n}));o(n,(()=>!r)).then(t)}))}function T(n){return t((function(t){let e=null;n.then((n=>{n!==e&&c(n)&&(t(n),e=n)}))}))}function J(n,t){const e=u(),r={};return n.then((n=>{e.use(N(r,n,((n,t)=>{if(Array.isArray(n))return n.concat(t)})))})),t&&t.then((n=>{e.use(n)})),e}function N(n,t,e){return null==t||Object.keys(t).forEach((r=>{const i=t[r],o=n[r],c=e(o,i,r,n,t);void 0!==c?n[r]=c:A(i)&&A(o)?N(o,i,e):n[r]=i})),n}function A(n){return null!=n&&"object"==typeof n}function F(n){return t((function(t){let e=!1;n.then((n=>{!1===e?e=!0:t(n)}))}))}function k(t,r){const o=i(t),u=i(n(r));return s((function(n){h(o,u).then((([t,e])=>{const r=e.split(".");let i=t;r.forEach((n=>{i=i[n]})),void 0!==i&&i!==t&&n(i)}))}),(n=>{const r=e(u);if(c(r)){const i=e(t);t.use({...i.primitiveWithException(),[r.primitiveWithException()]:n})}}))}function P(e,r,i){const o=n(r),c=n(i);return t((function(n){h(e,o,c).then((([t,e,r])=>{const i=e.split(".");let o=t;i.forEach((n=>{o=o[n]})),void 0!==o&&o!==t?n(o):void 0!==r&&n(r)}))}))}function R(t,e){const r=n(t),i=n(e);return l(P(r,i,a))}function D(n,e){return t((function(t){e.then((()=>{n.then(t)}))}))}function L(n,r){return t((function(t){const i=e(n);i.primitive(),r.then((()=>{const n=i.primitive();c(n)&&t(n)}))}))}function M(e,r=0){const i=n(e);return t((function(n){let t=null;p(i,(n=>e=>{t&&clearTimeout(t),t=setTimeout((()=>{n(e)}),r)})).then(n)}))}function W(n){return t((function(t){let e=!1,r=null;n.then((n=>{r=n,e||(e=!0,queueMicrotask((()=>{e=!1,null!==r&&(t(r),r=null)})))}))}))}function q(n,e){return t((function(t){h(n,e).then((([n,e])=>{t(!(!n||!e))}))}))}function B(n){return t((function(t){f(n,Boolean).then(t)}))}function I(n){return t((function(t){n.then((n=>{t(!n)}))}))}function z(n,e){return t((function(t){h(n,e).then((([n,e])=>{t(!(!n&&!e))}))}))}function C(n){return t((function(t,e){n.then((n=>{try{t(JSON.parse(n))}catch(n){e(new Error(`Failed to parse JSON: ${n}`))}}))}))}function G(n){return t((function(t,e){n.then((n=>{try{t(JSON.stringify(n))}catch{e(new Error("Failed to convert to JSON"))}}))}))}function H(n){return t((function(t){f(n,(n=>n[0])).then(t)}))}function K(e,r,i=d("")){const o=n(e),c=n(r),u=n(i);return t((function(n){h(o,c,u).then((([t,e,r])=>{const i=new RegExp(t,r).exec(e);n(i??[])}))}))}function Q(e,r,i=d("")){const o=n(e),c=n(r),u=n(i);return t((function(n){h(o,c,u).then((([t,e,r])=>{n(new RegExp(t,r).test(e))}))}))}function U(n,e,r,i=d("")){return t((function(t){h(e,n,r,i).then((([n,e,r,i])=>{t(String(e).replace(new RegExp(n,i),r))}))}))}function V(e,r,i){const o=n(e),c=n(r),u=n(i);return t((function(n){h(o,c,u).then((([t,e,r])=>{t[e]=r,n(t)}))}))}function X(e,i,o){const c=n(i);return t((function(n){const t=r(),i=()=>{t.destroy()};return h(c,e).then((([e,r])=>{i();h(...e.map((n=>Q(d(n.pattern),d(r),n.patternFlags?d(n.patternFlags):void 0)))).then((r=>{const i=r.findIndex((n=>!0===n));if(-1===i){const e=o();t.add(e),e.then(n)}if(i>-1){const r=e[i].message();t.add(r),r.then(n)}}))})),i}))}function Y(n,e=d("")){return t((function(t){h(e,...n).then((([n,...e])=>{t(e.join(n))}))}))}function Z(n){return t((function(t){const e={};n.then((([n,r])=>{e[n]=r,t(e)}))}))}function _(e){return t((function(t){const r=Object.keys(e);r.forEach((t=>{e[t]=n(e[t])})),h(...Object.values(e)).then((n=>{const e={};n.forEach(((n,t)=>{e[r[t]]=n})),t(e)}))}))}var nn=Object.defineProperty,tn=(n,t,e)=>((n,t,e)=>t in n?nn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e)(n,"symbol"!=typeof t?t+"":t,e);function en(e="",r=d({})){const i=u();("string"==typeof e||v(e))&&i.chain(n(e));const o=new rn(i,r?n(r):void 0);return"function"==typeof e&&i.chain(t((n=>{n(e(o))}))),o}class rn{constructor(n=d(""),t=d({})){this.$src=n,this.$places=t,tn(this,"dc",r()),tn(this,"rejections",new m),tn(this,"vars",{$TPL:d("$TPL")})}then(n){const t=_(this.vars);return f(h(this.$src,this.$places,t),(([n,t,e])=>{try{Object.entries(t).forEach((([t,e])=>{n=n.replaceAll(t,String(e))})),Object.entries(e).forEach((([t,e])=>{n=n.replaceAll(t,String(e))}))}catch(n){this.rejections.reject(n)}return n})).then(n),this}template(n){this.$src=d(n)}var(n){const t=`$var${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;return y(n)&&this.dc.add(n),this.vars[t]=n,t}catch(n){return this.rejections.catch(n),this}destroy(){return this.dc.destroy(),this}}export{q as And,B as Bool,g as Branch,E as BranchLazy,Y as Concatenated,b as Constant,j as Deadline,O as Deferred,S as Detached,w as Dirty,H as First,C as FromJson,Z as HashTable,$ as Loading,x as Lock,T as Memo,J as MergeAccumulation,I as Not,F as OnlyChanged,z as Or,k as Part,P as Path,R as PathExisted,D as Polling,_ as Record,K as RegexpMatch,Q as RegexpMatched,U as RegexpReplaced,X as Router,V as Set,L as Shot,M as Task,en as Template,W as Tick,G as ToJson};
//# sourceMappingURL=silentium-components.min.mjs.map
