import{ActualMessage as n,Message as t,Primitive as e,DestroyContainer as r,ResetSilenceCache as o,Shared as c,Filtered as i,isFilled as u,Late as s,MessageSource as f,Applied as h,All as a,Empty as l,Nothing as p,Computed as d,ExecutorApplied as y,Of as v,Once as m,Map as b,isMessage as j,Rejections as g,isDestroyable as E}from"silentium";function O(r,o,c){const i=n(r),u=n(o),s=n(c);return t((function(n){const t=e(u);let r;void 0!==c&&(r=e(s)),i.then((e=>{if("boolean"!=typeof e)throw new Error("Branch received not boolean value");let o=null;!0===e?o=t.primitive():r&&(o=r.primitive()),null!==o&&n(o)}))}))}function w(n,e,o){return t((function(t){const c=r(),i=()=>{c.destroy()};return n.then((n=>{let r;i(),n?r=e():o&&(r=o()),void 0!==r&&(r.then(t),c.add(r))})),i}))}function S(n,e){return t((function(t,r){e.catch(r).then((()=>{t(n),t(o)}))}))}function x(e,r){const o=n(r);return t((function(n,t){let r=0;const u=c(e);o.then((e=>{r&&clearTimeout(r);let o=!1;r=setTimeout((()=>{o||(o=!0,t(new Error("Timeout reached in Deadline")))}),e);i(u,(()=>!o)).then(n),u.then((()=>{o=!0}))}))}))}function $(n,r){return t((function(t){const o=e(n);r.then((()=>{const n=o.primitive();u(n)&&t(n)}))}))}function A(n){return t((function(t){const r=e(n).primitive();u(r)&&t(r)}))}function F(n,t=[],e=[],r){const o=s({});return void 0===r&&(r=n=>JSON.parse(JSON.stringify(n))),f((function(c){const i=h(o,r);a(i,n).then((([n,r])=>{n&&c(Object.fromEntries(Object.entries(n).filter((([n,o])=>!!t.includes(n)||!e.includes(n)&&o!==r[n]))))}))}),(n=>{o.use(n)}))}function T(n,e){return t((function(t){n.then((()=>t(!0))),e.then((()=>t(!1)))}))}function J(n,e){return t((function(t){let r=!1;e.then((n=>{r=n}));i(n,(()=>!r)).then(t)}))}function N(n){return t((function(t){let e=null;n.then((n=>{n!==e&&u(n)&&(t(n),e=n)}))}))}function k(n,t){const e=s(),r={};return n.then((n=>{e.use(P(r,n,((n,t)=>{if(Array.isArray(n))return n.concat(t)})))})),t&&t.then((n=>{e.use(n)})),e}function P(n,t,e){return null==t||Object.keys(t).forEach((r=>{const o=t[r],c=n[r],i=e(c,o,r,n,t);void 0!==i?n[r]=i:R(o)&&R(c)?P(c,o,e):n[r]=o})),n}function R(n){return null!=n&&"object"==typeof n}function q(n){return t((function(t){let e=!1;n.then((n=>{!1===e?e=!0:t(n)}))}))}function B(t,r){const o=c(t),i=c(n(r));return f((function(n){a(o,i).then((([t,e])=>{const r=e.split(".");let o=t;r.forEach((n=>{o=o[n]})),void 0!==o&&o!==t&&n(o)}))}),(n=>{const r=e(i);if(u(r)){const o=e(t);t.use({...o.primitiveWithException(),[r.primitiveWithException()]:n})}}))}const D=Symbol("not-set");function L(t,e,r){const o=n(e),c=n(r??D);return h(a(t,o,c),(([n,t,e])=>{const r=t.split(".");let o=n;return r.forEach((n=>{o=o[n]})),void 0!==o&&o!==n?o:e!==D?e:void 0}))}function M(t,e){const r=n(t),o=n(e);return l(L(r,o,p))}function W(n,e){return t((function(t){e.then((()=>{n.then(t)}))}))}function I(t,e){const r=n(t),o=n(e),c=(n,t)=>{if(null===n||"object"!=typeof n||Array.isArray(n))return n;const e={};for(const[r,o]of Object.entries(n)){if(t.includes(o))continue;const n=c(o,t);void 0===n||"object"==typeof n&&null!==n&&!Array.isArray(n)&&0===Object.keys(n).length||(e[r]=n)}return e};return d(c,r,o)}function z(n,r){return t((function(t){const o=e(n);o.primitive(),r.then((()=>{const n=o.primitive();u(n)&&t(n)}))}))}function C(e,r=0){const o=n(e);return t((function(n){let t=null;y(o,(n=>e=>{t&&clearTimeout(t),t=setTimeout((()=>{n(e)}),r)})).then(n)}))}function G(n){return t((function(t){let e=!1,r=null;n.then((n=>{r=n,e||(e=!0,queueMicrotask((()=>{e=!1,null!==r&&(t(r),r=null)})))}))}))}function H(n){return t((function(t){const e={};n.then((([n,r])=>{e[n]=r,t(e)}))}))}function K(e){return t((function(t){const r=Object.keys(e);r.forEach((t=>{e[t]=n(e[t])})),a(...Object.values(e)).then((n=>{const e={};n.forEach(((n,t)=>{e[r[t]]=n})),t(e)}))}))}function Q(e,r){const o=n(e);return t((n=>{o.then((t=>{const e={},o=Object.fromEntries(Object.entries(t).map((n=>r[n[0]]?(e[n[0]]=1,[n[0],r[n[0]](t)]):[n[0],v(n[1])])));Object.keys(r).forEach((n=>{e[n]||(o[n]=r[n](t))}));m(K(o)).then(n)}))}))}function U(t,e){return b(n(t),(n=>Q(n,e)))}function V(n,e){return t((function(t){a(n,e).then((([n,e])=>{t(!(!n||!e))}))}))}function X(n){return t((function(t){h(n,Boolean).then(t)}))}function Y(n){return t((function(t){n.then((n=>{t(!n)}))}))}function Z(n,e){return t((function(t){a(n,e).then((([n,e])=>{t(!(!n&&!e))}))}))}function _(n){return t((function(t,e){n.then((n=>{try{t(JSON.parse(n))}catch(n){e(new Error(`Failed to parse JSON: ${n}`))}}))}))}function nn(n){return t((function(t,e){n.then((n=>{try{t(JSON.stringify(n))}catch{e(new Error("Failed to convert to JSON"))}}))}))}function tn(n){return t((function(t){h(n,(n=>n[0])).then(t)}))}function en(e,r,o=v("")){const c=n(e),i=n(r),u=n(o);return t((function(n){a(c,i,u).then((([t,e,r])=>{const o=new RegExp(t,r).exec(e);n(o??[])}))}))}function rn(e,r,o=v("")){const c=n(e),i=n(r),u=n(o);return t((function(n){a(c,i,u).then((([t,e,r])=>{n(new RegExp(t,r).test(e))}))}))}function on(t,e,r,o=""){const c=n(t),i=n(e),u=n(r),s=n(o);return h(a(i,c,u,s),(([n,t,e,r])=>String(t).replace(new RegExp(n,r),e)))}function cn(e,r,o){const c=n(e),i=n(r),u=n(o);return t((function(n){a(c,i,u).then((([t,e,r])=>{t[e]=r,n(t)}))}))}function un(e,o,c){const i=n(o);return t((function(n){const t=r(),o=()=>{t.destroy()};return a(i,e).then((([e,r])=>{o();a(...e.map((n=>rn(v(n.pattern),v(r),n.patternFlags?v(n.patternFlags):void 0)))).then((r=>{const o=r.findIndex((n=>!0===n));if(-1===o){const e=c();t.add(e),e.then(n)}if(o>-1){const r=e[o].message();t.add(r),r.then(n)}}))})),o}))}function sn(n,e=v("")){return t((function(t){a(e,...n).then((([n,...e])=>{t(e.join(n))}))}))}var fn=Object.defineProperty,hn=(n,t,e)=>((n,t,e)=>t in n?fn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e)(n,"symbol"!=typeof t?t+"":t,e);function an(e="",r=v({})){const o=s();("string"==typeof e||j(e))&&o.chain(n(e));const c=new ln(o,r?n(r):void 0);return"function"==typeof e&&o.chain(t((n=>{n(e(c))}))),c}class ln{constructor(n=v(""),t=v({}),e=dn){this.$src=n,this.$places=t,this.escapeFn=e,hn(this,"dc",r()),hn(this,"rejections",new g),hn(this,"vars",{$TPL:v("$TPL")})}then(n){const t=K(this.vars);return h(a(this.$src,this.$places,t),(([n,t,e])=>{try{Object.entries(t).forEach((([t,e])=>{n=n.replaceAll(t,String(e))})),Object.entries(e).forEach((([t,e])=>{n=n.replaceAll(t,String(e))}))}catch(n){this.rejections.reject(n)}return n})).then(n),this}template(n){this.$src=v(n)}raw(n){const t=`$var${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;return E(n)&&this.dc.add(n),this.vars[t]=n,t}escaped(n){return E(n)&&this.dc.add(n),this.raw(h(n,this.escapeFn))}catch(n){return this.rejections.catch(n),this}destroy(){return this.dc.destroy(),this}}const pn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};function dn(n){return n.replace(/[&<>"'/]/g,(n=>pn[n]))}export{V as And,X as Bool,O as Branch,w as BranchLazy,sn as Concatenated,S as Constant,x as Deadline,$ as Deferred,A as Detached,F as Dirty,tn as First,_ as FromJson,H as HashTable,T as Loading,J as Lock,N as Memo,k as MergeAccumulation,Y as Not,q as OnlyChanged,Z as Or,B as Part,L as Path,M as PathExisted,W as Polling,K as Record,I as RecordTruncated,en as RegexpMatch,rn as RegexpMatched,on as RegexpReplaced,un as Router,cn as Set,z as Shot,C as Task,an as Template,ln as TemplateImpl,G as Tick,nn as ToJson,Q as Transformed,U as TransformedList,dn as escaped};
//# sourceMappingURL=silentium-components.min.mjs.map
