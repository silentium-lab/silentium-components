import{ActualMessage as n,Message as t,Primitive as e,DestroyContainer as r,Shared as i,Filtered as o,isFilled as c,Late as u,MessageSource as s,Applied as f,All as h,LateShared as l,Empty as a,Nothing as p,ExecutorApplied as d,Of as v,isMessage as m,Rejections as y,isDestroyable as g}from"silentium";function E(r,i,o){const c=n(r),u=n(i),s=o&&n(o);return t((function(n){const t=e(u);let r;void 0!==s&&(r=e(s)),c.then((e=>{let i=null;e?i=t.primitive():r&&(i=r.primitive()),null!==i&&n(i)}))}))}function b(n,e,i){return t((function(t){const o=r(),c=()=>{o.destroy()};return n.then((n=>{let r;c(),n?r=e():i&&(r=i()),void 0!==r&&(r.then(t),o.add(r))})),c}))}function j(n,e){return t((function(t){e.then((()=>{t(n)}))}))}function O(e,r){const c=n(r);return t((function(n,t){let r=0;const u=i(e);c.then((e=>{r&&clearTimeout(r);let i=!1;r=setTimeout((()=>{i||(i=!0,t(new Error("Timeout reached in Deadline")))}),e);o(u,(()=>!i)).then(n),u.then((()=>{i=!0}))}))}))}function S(n,r){return t((function(t){const i=e(n);r.then((()=>{const n=i.primitive();c(n)&&t(n)}))}))}function w(n){return t((function(t){const r=e(n).primitive();c(r)&&t(r)}))}function $(n,t=[],e=[],r){const i=u();return void 0===r&&(r=n=>JSON.parse(JSON.stringify(n))),s((function(o){const c=f(i,r);h(c,n).then((([n,r])=>{n&&o(Object.fromEntries(Object.entries(n).filter((([n,i])=>!!t.includes(n)||!e.includes(n)&&i!==r[n]))))}))}),(n=>{i.use(n)}))}function x(n,e){return t((function(t){n.then((()=>t(!0))),e.then((()=>t(!1)))}))}function T(n,e){return t((function(t){let r=!1;e.then((n=>{r=n}));o(n,(()=>!r)).then(t)}))}function J(n){return t((function(t){let e=null;n.then((n=>{n!==e&&c(n)&&(t(n),e=n)}))}))}function N(n,t){const e=l(),r={};return n.then((n=>{e.use(A(r,n,((n,t)=>{if(Array.isArray(n))return n.concat(t)})))})),t&&t.then((n=>{e.use(n)})),e}function A(n,t,e){return null==t||Object.keys(t).forEach((r=>{const i=t[r],o=n[r],c=e(o,i,r,n,t);void 0!==c?n[r]=c:F(i)&&F(o)?A(o,i,e):n[r]=i})),n}function F(n){return null!=n&&"object"==typeof n}function k(n){return t((function(t){let e=!1;n.then((n=>{!1===e?e=!0:t(n)}))}))}function P(t,r){const o=i(t),u=i(n(r));return s((function(n){h(o,u).then((([t,e])=>{const r=e.split(".");let i=t;r.forEach((n=>{i=i[n]})),void 0!==i&&i!==t&&n(i)}))}),(n=>{const r=e(u);if(c(r)){const i=e(t);t.use({...i.primitiveWithException(),[r.primitiveWithException()]:n})}}))}function R(e,r,i){const o=n(r),c=n(i);return t((function(n){h(e,o,c).then((([t,e,r])=>{const i=e.split(".");let o=t;i.forEach((n=>{o=o[n]})),void 0!==o&&o!==t?n(o):void 0!==r&&n(r)}))}))}function D(t,e){const r=n(t),i=n(e);return a(R(r,i,p))}function L(n,e){return t((function(t){e.then((()=>{n.then(t)}))}))}function M(n,r){return t((function(t){const i=e(n);i.primitive(),r.then((()=>{const n=i.primitive();c(n)&&t(n)}))}))}function W(e,r=0){const i=n(e);return t((function(n){let t=null;d(i,(n=>e=>{t&&clearTimeout(t),t=setTimeout((()=>{n(e)}),r)})).then(n)}))}function q(n){return t((function(t){let e=!1,r=null;n.then((n=>{r=n,e||(e=!0,queueMicrotask((()=>{e=!1,null!==r&&(t(r),r=null)})))}))}))}function B(n,e){return t((function(t){h(n,e).then((([n,e])=>{t(!(!n||!e))}))}))}function I(n){return t((function(t){f(n,Boolean).then(t)}))}function z(n){return t((function(t){n.then((n=>{t(!n)}))}))}function C(n,e){return t((function(t){h(n,e).then((([n,e])=>{t(!(!n&&!e))}))}))}function G(n){return t((function(t,e){n.then((n=>{try{t(JSON.parse(n))}catch(n){e(new Error(`Failed to parse JSON: ${n}`))}}))}))}function H(n){return t((function(t,e){n.then((n=>{try{t(JSON.stringify(n))}catch{e(new Error("Failed to convert to JSON"))}}))}))}function K(n){return t((function(t){f(n,(n=>n[0])).then(t)}))}function Q(e,r,i=v("")){const o=n(e),c=n(r),u=n(i);return t((function(n){h(o,c,u).then((([t,e,r])=>{const i=new RegExp(t,r).exec(e);n(i??[])}))}))}function U(e,r,i=v("")){const o=n(e),c=n(r),u=n(i);return t((function(n){h(o,c,u).then((([t,e,r])=>{n(new RegExp(t,r).test(e))}))}))}function V(n,e,r,i=v("")){return t((function(t){h(e,n,r,i).then((([n,e,r,i])=>{t(String(e).replace(new RegExp(n,i),r))}))}))}function X(e,r,i){const o=n(e),c=n(r),u=n(i);return t((function(n){h(o,c,u).then((([t,e,r])=>{t[e]=r,n(t)}))}))}function Y(e,i,o){const c=n(i);return t((function(n){const t=r(),i=()=>{t.destroy()};return h(c,e).then((([e,r])=>{i();h(...e.map((n=>U(v(n.pattern),v(r),n.patternFlags?v(n.patternFlags):void 0)))).then((r=>{const i=r.findIndex((n=>!0===n));if(-1===i){const e=o();t.add(e),e.then(n)}if(i>-1){const r=e[i].message();t.add(r),r.then(n)}}))})),i}))}function Z(n,e=v("")){return t((function(t){h(e,...n).then((([n,...e])=>{t(e.join(n))}))}))}function _(n){return t((function(t){const e={};n.then((([n,r])=>{e[n]=r,t(e)}))}))}function nn(e){return t((function(t){const r=Object.keys(e);r.forEach((t=>{e[t]=n(e[t])})),h(...Object.values(e)).then((n=>{const e={};n.forEach(((n,t)=>{e[r[t]]=n})),t(e)}))}))}var tn=Object.defineProperty,en=(n,t,e)=>((n,t,e)=>t in n?tn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e)(n,"symbol"!=typeof t?t+"":t,e);function rn(e="",r=v({})){const i=l();("string"==typeof e||m(e))&&i.chain(n(e));const o=new on(i,r?n(r):void 0);return"function"==typeof e&&i.chain(t((n=>{n(e(o))}))),o}class on{constructor(n=v(""),t=v({})){this.$src=n,this.$places=t,en(this,"dc",r()),en(this,"rejections",new y),en(this,"vars",{$TPL:v("$TPL")})}then(n){const t=nn(this.vars);return f(h(this.$src,this.$places,t),(([n,t,e])=>{try{Object.entries(t).forEach((([t,e])=>{n=n.replaceAll(t,String(e))})),Object.entries(e).forEach((([t,e])=>{n=n.replaceAll(t,String(e))}))}catch(n){this.rejections.reject(n)}return n})).then(n),this}template(n){this.$src=v(n)}var(n){const t=`$var${Date.now().toString(36)+Math.random().toString(36).substring(2)}`;return g(n)&&this.dc.add(n),this.vars[t]=n,t}catch(n){return this.rejections.catch(n),this}destroy(){return this.dc.destroy(),this}}export{B as And,I as Bool,E as Branch,b as BranchLazy,Z as Concatenated,j as Constant,O as Deadline,S as Deferred,w as Detached,$ as Dirty,K as First,G as FromJson,_ as HashTable,x as Loading,T as Lock,J as Memo,N as MergeAccumulation,z as Not,k as OnlyChanged,C as Or,P as Part,R as Path,D as PathExisted,L as Polling,nn as Record,Q as RegexpMatch,U as RegexpMatched,V as RegexpReplaced,Y as Router,X as Set,M as Shot,W as Task,rn as Template,q as Tick,H as ToJson};
//# sourceMappingURL=silentium-components.min.mjs.map
