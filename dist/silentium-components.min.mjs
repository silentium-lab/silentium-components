import{ActualMessage as t,Message as e,Primitive as n,Transport as r,DestroyContainer as o,Shared as s,Filtered as i,isFilled as u,Late as c,Applied as l,All as a,SharedSource as f,ExecutorApplied as h,LateShared as p,Of as d,isMessage as m,isDestroyable as b}from"silentium";function v(o,s,i){const u=t(o),c=t(s),l=i&&t(i);return e((t=>{const e=n(c);let o;void 0!==l&&(o=n(l)),u.to(r((n=>{let r=null;n?r=e.primitive():o&&(r=o.primitive()),null!==r&&t.use(r)})))}))}function y(t,n,s){return e((e=>{const i=o(),u=()=>{i.destroy()};return t.to(r((t=>{let r;u(),t?r=n.use():s&&(r=s.use()),void 0!==r&&(r.to(e),i.add(r))}))),u}))}function $(t,n){return e((e=>{n.to(r((()=>{e.use(t)})))}))}function g(n,o,u){const c=t(u);return e((t=>{let e=0;const u=s(o,!0);c.to(r((o=>{e&&clearTimeout(e);let s=!1;e=setTimeout((()=>{s||(s=!0,n.use(new Error("Timeout reached in Deadline")))}),o);i(u,(()=>!s)).to(t),u.to(r((()=>{s=!0})))})))}))}function E(t,o){return e((e=>{const s=n(t);o.to(r((()=>{const t=s.primitive();u(t)&&e.use(t)})))}))}function O(t){return e((e=>{const r=n(t).primitive();u(r)&&e.use(r)}))}var w=Object.defineProperty,j=(t,e,n)=>((t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function x(t,e=[],n=[],r){return new k(t,e,n,r)}class k{constructor(t,e=[],n=[],r){this.$base=t,this.keep=e,this.exclude=n,j(this,"$comparing",c()),j(this,"cloner"),this.cloner=void 0===r?t=>JSON.parse(JSON.stringify(t)):r}to(t){const e=l(this.$comparing,this.cloner);return a(e,this.$base).to(r((([e,n])=>{e&&t.use(Object.fromEntries(Object.entries(e).filter((([t,e])=>!!this.keep.includes(t)||!this.exclude.includes(t)&&e!==n[t]))))}))),this}use(t){return this.$comparing.use(t),this}}function S(t,n){return e((e=>{t.to(r((()=>e.use(!0)))),n.to(r((()=>e.use(!1))))}))}function T(t,n){return e((e=>{let o=!1;n.to(r((t=>{o=t})));i(t,(()=>!o)).to(e)}))}function J(t){return e((e=>{let n=null;t.to(r((t=>{t!==n&&u(t)&&(e.use(t),n=t)})))}))}function N(t){return e((e=>{let n=!1;t.to(r((t=>{!1===n?n=!0:e.use(t)})))}))}var P=Object.defineProperty,F=(t,e,n)=>((t,e,n)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function R(e,n){return new A(e,t(n))}class A{constructor(t,e){F(this,"$base"),F(this,"$keyed"),this.$base=f(t),this.$keyed=s(e)}to(t){return a(this.$base,this.$keyed).to(r((([e,n])=>{const r=n.split(".");let o=e;r.forEach((t=>{o=o[t]})),void 0!==o&&o!==e&&t.use(o)}))),this}use(t){const e=n(this.$keyed);if(u(e)){const r=n(this.$base);this.$base.use({...r.primitiveWithException(),[e.primitiveWithException()]:t})}return this}}function L(n,o){const s=t(o);return e((t=>{a(n,s).to(r((([e,n])=>{const r=n.split(".");let o=e;r.forEach((t=>{o=o[t]})),void 0!==o&&o!==e&&t.use(o)})))}))}function W(t,n){return e((e=>{n.to(r((()=>{t.to(e)})))}))}function q(t,o){return e((e=>{const s=n(t);s.primitive(),o.to(r((()=>{const t=s.primitive();u(t)&&e.use(t)})))}))}function B(t,n=0){return e((e=>{let r=null;h(t,(t=>e=>{r&&clearTimeout(r),r=setTimeout((()=>{t(e)}),n)})).to(e)}))}function D(t){return e((e=>{let n=!1,o=null;t.to(r((t=>{o=t,n||(n=!0,queueMicrotask((()=>{n=!1,null!==o&&(e.use(o),o=null)})))})))}))}function I(t,n,...o){return e((e=>{const s=p(),i=[];return t.to(r((t=>{const e=n(d(t),...o.map((t=>O(t))));i.push(e),e.to(s)}))),s.to(e),()=>{i.forEach((t=>t?.destroy())),i.length=0}}))}function M(t){return e((e=>{const n={};t.to(r((([t,r])=>{n[t]=r,e.use(n)})))}))}function z(t){return e((e=>{const n=Object.keys(t);n.forEach((e=>{m(t[e])||(t[e]=d(t[e]))})),a(...Object.values(t)).to(r((t=>{const r={};t.forEach(((t,e)=>{r[n[e]]=t})),e.use(r)})))}))}function C(t,n=d("")){return e((e=>{a(n,...t).to(r((([t,...n])=>{e.use(n.join(t))})))}))}var G=Object.defineProperty,H=(t,e,n)=>((t,e,n)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function K(t=d(""),e=d({})){return new Q(t,e)}class Q{constructor(t=d(""),e=d({})){this.$src=t,this.$places=e,H(this,"dc",o()),H(this,"vars",{$TPL:d("$TPL")})}to(t){const e=z(this.vars);return l(a(this.$src,this.$places,e),(([t,e,n])=>(Object.entries(e).forEach((([e,n])=>{t=t.replaceAll(e,String(n))})),Object.entries(n).forEach((([e,n])=>{t=t.replaceAll(e,String(n))})),t))).to(t),this}template(t){this.$src=d(t)}var(t){const e=`$var${Object.keys(this.vars).length}`;return b(t)&&this.dc.add(t),this.vars[e]=t,e}destroy(){return this.dc.destroy(),this}}function U(t,n,o=d("")){return e((e=>{a(t,n,o).to(r((([t,n,r])=>{e.use(new RegExp(t,r).test(n))})))}))}function V(t,n,o,s=d("")){return e((e=>{a(n,t,o,s).to(r((([t,n,r,o])=>{e.use(String(n).replace(new RegExp(t,o),r))})))}))}function X(t,n,o=d("")){return e((e=>{a(t,n,o).to(r((([t,n,r])=>{const o=new RegExp(t,r).exec(n);e.use(o??[])})))}))}function Y(t,n,o){return e((e=>{a(t,n,o).to(r((([t,n,r])=>{t[n]=r,e.use(t)})))}))}function Z(t,n,s){return e((e=>{const i=o(),u=()=>{i.destroy()};return a(n,t).to(r((([t,n])=>{u();a(...t.map((t=>U(d(t.pattern),d(n),t.patternFlags?d(t.patternFlags):void 0)))).to(r((n=>{const r=n.findIndex((t=>!0===t));if(-1===r){const t=s.use();i.add(t),t.to(e)}if(r>-1){const n=t[r].message.use();i.add(n),n.to(e)}})))}))),u}))}function _(t,n){return e((e=>{a(t,n).to(r((([t,n])=>{e.use(t&&n)})))}))}function tt(t,n){return e((e=>{a(t,n).to(r((([t,n])=>{e.use(t||n)})))}))}function et(t){return e((e=>{t.to(r((t=>{e.use(!t)})))}))}function nt(t){return e((e=>{l(t,Boolean).to(e)}))}function rt(t,n){return e((e=>{t.to(r((t=>{try{e.use(JSON.parse(t))}catch(t){n?.use(new Error(`Failed to parse JSON: ${t}`))}})))}))}function ot(t,n){return e((e=>{t.to(r((t=>{try{e.use(JSON.stringify(t))}catch{n?.use(new Error("Failed to convert to JSON"))}})))}))}function st(t){return e((e=>{l(t,(t=>t[0])).to(e)}))}export{_ as And,nt as Bool,v as Branch,y as BranchLazy,C as Concatenated,$ as Constant,g as Deadline,E as Deferred,O as Detached,x as Dirty,st as First,rt as FromJson,M as HashTable,S as Loading,T as Lock,J as Memo,et as Not,N as OnlyChanged,tt as Or,R as Part,L as Path,W as Polling,z as Record,X as RegexpMatch,U as RegexpMatched,V as RegexpReplaced,Z as Router,Y as Set,q as Shot,B as Task,K as Template,D as Tick,ot as ToJson,I as Transaction};
//# sourceMappingURL=silentium-components.min.mjs.map
