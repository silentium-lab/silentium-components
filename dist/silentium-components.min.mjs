import{Message as t,Primitive as e,Transport as n,DestroyContainer as r,Shared as o,Filtered as s,isFilled as i,Late as u,Applied as c,All as l,SharedSource as a,ExecutorApplied as f,LateShared as h,Of as p,isMessage as d,isDestroyable as m}from"silentium";function b(r,o,s){return t((t=>{const i=e(o);let u;void 0!==s&&(u=e(s)),r.to(n((e=>{let n=null;e?n=i.primitive():u&&(n=u.primitive()),null!==n&&t.use(n)})))}))}function v(e,o,s){return t((t=>{const i=r(),u=()=>{i.destroy()};return e.to(n((e=>{let n;u(),e?n=o.use():s&&(n=s.use()),void 0!==n&&(n.to(t),i.add(n))}))),u}))}function y(e,r){return t((t=>{r.to(n((()=>{t.use(e)})))}))}function $(e,r,i){return t((t=>{let u=0;const c=o(r,!0);i.to(n((r=>{u&&clearTimeout(u);let o=!1;u=setTimeout((()=>{o||(o=!0,e.use(new Error("Timeout reached in Deadline")))}),r);s(c,(()=>!o)).to(t),c.to(n((()=>{o=!0})))})))}))}function g(r,o){return t((t=>{const s=e(r);o.to(n((()=>{const e=s.primitive();i(e)&&t.use(e)})))}))}function E(n){return t((t=>{const r=e(n).primitive();i(r)&&t.use(r)}))}var O=Object.defineProperty,w=(t,e,n)=>((t,e,n)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function j(t,e=[],n=[],r){return new x(t,e,n,r)}class x{constructor(t,e=[],n=[],r){this.$base=t,this.keep=e,this.exclude=n,w(this,"$comparing",u()),w(this,"cloner"),this.cloner=void 0===r?t=>JSON.parse(JSON.stringify(t)):r}to(t){const e=c(this.$comparing,this.cloner);return l(e,this.$base).to(n((([e,n])=>{e&&t.use(Object.fromEntries(Object.entries(e).filter((([t,e])=>!!this.keep.includes(t)||!this.exclude.includes(t)&&e!==n[t]))))}))),this}use(t){return this.$comparing.use(t),this}}function k(e,r){return t((t=>{e.to(n((()=>t.use(!0)))),r.to(n((()=>t.use(!1))))}))}function S(e,r){return t((t=>{let o=!1;r.to(n((t=>{o=t})));s(e,(()=>!o)).to(t)}))}function T(e){return t((t=>{let r=null;e.to(n((e=>{e!==r&&i(e)&&(t.use(e),r=e)})))}))}function J(e){return t((t=>{let r=!1;e.to(n((e=>{!1===r?r=!0:t.use(e)})))}))}var N=Object.defineProperty,P=(t,e,n)=>((t,e,n)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function F(t,e){return new R(t,e)}class R{constructor(t,e){P(this,"$base"),P(this,"$keyed"),this.$base=a(t),this.$keyed=o(e)}to(t){return l(this.$base,this.$keyed).to(n((([e,n])=>{const r=n.split(".");let o=e;r.forEach((t=>{o=o[t]})),void 0!==o&&o!==e&&t.use(o)}))),this}use(t){const n=e(this.$keyed);if(i(n)){const r=e(this.$base);this.$base.use({...r.primitiveWithException(),[n.primitiveWithException()]:t})}return this}}function A(e,r){return t((t=>{l(e,r).to(n((([e,n])=>{const r=n.split(".");let o=e;r.forEach((t=>{o=o[t]})),void 0!==o&&o!==e&&t.use(o)})))}))}function L(e,r){return t((t=>{r.to(n((()=>{e.to(t)})))}))}function W(r,o){return t((t=>{const s=e(r);s.primitive(),o.to(n((()=>{const e=s.primitive();i(e)&&t.use(e)})))}))}function q(e,n=0){return t((t=>{let r=null;f(e,(t=>e=>{r&&clearTimeout(r),r=setTimeout((()=>{t(e)}),n)})).to(t)}))}function B(e){return t((t=>{let r=!1,o=null;e.to(n((e=>{o=e,r||(r=!0,queueMicrotask((()=>{r=!1,null!==o&&(t.use(o),o=null)})))})))}))}function D(e,r,...o){return t((t=>{const s=h(),i=[];return e.to(n((t=>{const e=r(p(t),...o.map((t=>E(t))));i.push(e),e.to(s)}))),s.to(t),()=>{i.forEach((t=>t?.destroy())),i.length=0}}))}function I(e){return t((t=>{const r={};e.to(n((([e,n])=>{r[e]=n,t.use(r)})))}))}function M(e){return t((t=>{const r=Object.keys(e);r.forEach((t=>{d(e[t])||(e[t]=p(e[t]))})),l(...Object.values(e)).to(n((e=>{const n={};e.forEach(((t,e)=>{n[r[e]]=t})),t.use(n)})))}))}function z(e,r=p("")){return t((t=>{l(r,...e).to(n((([e,...n])=>{t.use(n.join(e))})))}))}var C=Object.defineProperty,G=(t,e,n)=>((t,e,n)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function H(t=p(""),e=p({})){return new K(t,e)}class K{constructor(t=p(""),e=p({})){this.$src=t,this.$places=e,G(this,"dc",r()),G(this,"vars",{$TPL:p("$TPL")})}to(t){const e=M(this.vars);return c(l(this.$src,this.$places,e),(([t,e,n])=>(Object.entries(e).forEach((([e,n])=>{t=t.replaceAll(e,String(n))})),Object.entries(n).forEach((([e,n])=>{t=t.replaceAll(e,String(n))})),t))).to(t),this}template(t){this.$src=p(t)}var(t){const e=`$var${Object.keys(this.vars).length}`;return m(t)&&this.dc.add(t),this.vars[e]=t,e}destroy(){return this.dc.destroy(),this}}function Q(e,r,o=p("")){return t((t=>{l(e,r,o).to(n((([e,n,r])=>{t.use(new RegExp(e,r).test(n))})))}))}function U(e,r,o,s=p("")){return t((t=>{l(r,e,o,s).to(n((([e,n,r,o])=>{t.use(String(n).replace(new RegExp(e,o),r))})))}))}function V(e,r,o=p("")){return t((t=>{l(e,r,o).to(n((([e,n,r])=>{const o=new RegExp(e,r).exec(n);t.use(o??[])})))}))}function X(e,r,o){return t((t=>{l(e,r,o).to(n((([e,n,r])=>{e[n]=r,t.use(e)})))}))}function Y(e,o,s){return t((t=>{const i=r(),u=()=>{i.destroy()};return l(o,e).to(n((([e,r])=>{u();l(...e.map((t=>Q(p(t.pattern),p(r),t.patternFlags?p(t.patternFlags):void 0)))).to(n((n=>{const r=n.findIndex((t=>!0===t));if(-1===r){const e=s.use();i.add(e),e.to(t)}if(r>-1){const n=e[r].message.use();i.add(n),n.to(t)}})))}))),u}))}function Z(e,r){return t((t=>{l(e,r).to(n((([e,n])=>{t.use(e&&n)})))}))}function _(e,r){return t((t=>{l(e,r).to(n((([e,n])=>{t.use(e||n)})))}))}function tt(e){return t((t=>{e.to(n((e=>{t.use(!e)})))}))}function et(e){return t((t=>{c(e,Boolean).to(t)}))}function nt(e,r){return t((t=>{e.to(n((e=>{try{t.use(JSON.parse(e))}catch(t){r?.use(new Error(`Failed to parse JSON: ${t}`))}})))}))}function rt(e,r){return t((t=>{e.to(n((e=>{try{t.use(JSON.stringify(e))}catch{r?.use(new Error("Failed to convert to JSON"))}})))}))}function ot(e){return t((t=>{c(e,(t=>t[0])).to(t)}))}export{Z as And,et as Bool,b as Branch,v as BranchLazy,z as Concatenated,y as Constant,$ as Deadline,g as Deferred,E as Detached,j as Dirty,ot as First,nt as FromJson,I as HashTable,k as Loading,S as Lock,T as Memo,tt as Not,J as OnlyChanged,_ as Or,F as Part,A as Path,L as Polling,M as Record,V as RegexpMatch,Q as RegexpMatched,U as RegexpReplaced,Y as Router,X as Set,W as Shot,q as Task,H as Template,B as Tick,rt as ToJson,D as Transaction};
//# sourceMappingURL=silentium-components.min.mjs.map
